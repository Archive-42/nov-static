<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<html>

<head>
      <title>README</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <link rel="stylesheet" href="file:///c:\Users\bryan\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">

  <link rel="stylesheet"
    href="file:///c:\Users\bryan\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">

  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.grid.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.css.map">
  <link rel="stylesheet" href="./../../css/blog-home.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/prism.css">
  <script async defer src="./../../vendor/bootstrap/css/prism.js"></script>
  <script async defer src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/highlight.min.js"></script>
  <link rel="stylesheet"
    href="file:///c:\Users\bryan\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/styles/default.min.css">


  <link rel="stylesheet" href="./cheatsheets.css">







<link rel="stylesheet" href="./cheatsheets.css">
    </head>
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->


<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->


    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="regex">regex</h1>

<h2 class="mume-header" id="tools">Tools:</h2>

<ul>
<li><a class="btn" href="https://regex101.com/">https://regex101.com/</a></li>
</ul>
<h2 class="mume-header" id="sources">Sources</h2>

<ul>
<li><a class="btn" href="https://groups.google.com/forum/#!topic/fluentd/arfxLzfU_5c">https://groups.google.com/forum/#!topic/fluentd/arfxLzfU_5c</a></li>
</ul>
<h2 class="mume-header" id="patterns">Patterns</h2>

<p>string:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">10.0.2.2 - - [19/Jul/2019 10:02:48] &quot;GET /?ccnum=1234 HTTP/1.1&quot; 200 -
</code></pre><p>match ccnum value:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">ccnum=\d+
</code></pre><p>match everything until ccnum=</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">\d+.\d+.\d+.\d+ .* \[\d{2}\/\w+\/\d{4}.*\d{2}:\d{2}:\d{2}\].*&quot;\w+.*\/?ccnum=\d+
</code></pre><p>Log:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">2020-04-21 08:37:04 172.16.1.1 - - [21/Apr/2020:08:37:04 +0200] &quot;POST /path?foo=bar HTTP/1.1&quot; 200 540 &quot;http://localhost/bar/&quot; &quot;Mozilla/5.0 (Linux; Android 10; One Build/One-Boo; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/81.0.4044.111 Mobile Safari/537.36&quot; &quot;1.1.1.1&quot;
</code></pre><p>Date:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">.[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]
.\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}
</code></pre><p>IP Address  <code class="language-javascript">10.173.4.20</code>:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript"> \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}
</code></pre><p>Apache / Nginx Log:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">172.128.80.109 - Bins5273 656 [2019-05-03T13:11:48-04:00] &quot;PUT /mesh&quot; 406 10272

^([\w\.]+) - ([\w]+) ([\d]+) \[(.*)\] &quot;([\w]+) (.*)&quot; ([\d]+) ([\d]+)$
</code></pre><pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">127.0.0.1 - - [21/Apr/2020:11:47:07 +0000] &quot;GET / HTTP/1.1&quot; 200 612 &quot;http://&quot; &quot;curl/7.58.0&quot;

^([\w\.]+) ([^ ]*) ([^ ]*) \[(.*)\] &quot;(\S+)(?: +([^ ]*) +\S*)?&quot; ([\d]+) ([\d]+) &quot;([^&quot;]*)&quot; &quot;([^\&quot;]*)&quot;?
</code></pre><pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">127.0.0.1 - - [21/Apr/2020:11:47:07 +0000] &quot;GET / HTTP/1.1&quot; 200 612 &quot;http://&quot; &quot;curl/7.58.0&quot;

^([\w\.]+) - ([^ ]*) \[(.*)\] &quot;([^ ]*) ([^ ]*) ([^ ]*)&quot; ([\d]+) ([\d]+) &quot;([^&quot;]*)&quot; &quot;([^\&quot;]*)&quot;?
</code></pre><pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">127.0.0.1 - - [21/Apr/2020:11:47:07 +0000] &quot;GET / HTTP/1.1&quot; 200 612 &quot;http://&quot; &quot;curl/7.58.0&quot; &quot;10.20.30.1&quot;

^([\w\.]+) - ([^ ]*) \[(.*)\] &quot;([^ ]*) ([^ ]*) ([^ ]*)&quot; ([\d]+) ([\d]+) &quot;([^&quot;]*)&quot; &quot;([^\&quot;]*)&quot; &quot;([\w\.]+)&quot;?
</code></pre><p>Assigning it labels with things like vector, promtail:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">^(?P&lt;remote_ip&gt;[\w\.]+) - (?P&lt;user&gt;[^ ]*) \[(?P&lt;timestamp&gt;.*)\] &quot;(?P&lt;method&gt;[^ ]*) (?P&lt;request_url&gt;[^ ]*) (?P&lt;request_http_protocol&gt;[^ ]*)&quot; (?P&lt;status&gt;[\d]+) (?P&lt;bytes_out&gt;[\d]+) &quot;(?P&lt;http_referer&gt;[^&quot;]*)&quot; &quot;(?P&lt;user_agent&gt;[^&quot;]*)&quot; &quot;(?P&lt;client_ip&gt;[\w\.]+)&quot;?
</code></pre><p>Full match value between brackets:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">this is [foo] bar
\(?\w+(?=\]):?
</code></pre><p>using positive lookbehind:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">this is [foo] bar
(?&lt;=\[)[\w+.-]*
</code></pre><p>Match everything up until  <code class="language-javascript">abc</code> but dont include it:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">/^(.*?)abc/
</code></pre><p>Or numbers:</p>
<pre data-role="codeBlock" data-info class="language-"> <code class="language-javascript">/^(.*?)[0-9]/
</code></pre>
      </div>
      <div class="md-sidebar-toc"><ul>
<li><a class="btn" href="#regex">regex</a>
<ul>
<li><a class="btn" href="#tools">Tools:</a></li>
<li><a class="btn" href="#sources">Sources</a></li>
<li><a class="btn" href="#patterns">Patterns</a></li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>








<script async>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>


    </body></html>
