<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<html>

<head>
      <title>promises</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <link rel="stylesheet" href="file:///c:\Users\bryan\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">


  <link rel="stylesheet"
    href="file:///c:\Users\bryan\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">

  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.grid.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/bootstrap.css.map">
  <link rel="stylesheet" href="./../../css/blog-home.css">
  <link rel="stylesheet" href="./../../vendor/bootstrap/css/prism.css">
  <script async defer src="./../../vendor/bootstrap/css/prism.js"></script>
  <script async defer src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/highlight.min.js"></script>
  <link rel="stylesheet"
    href="file:///c:\Users\bryan\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.5.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/styles/default.min.css">


  <link rel="stylesheet" href="./cheatsheets.css">






<link rel="stylesheet" href="./cheatsheets.css">
    </head>
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->


<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->
<!--------------------------------------------------------------------------------------------------->


    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="promises">Promises</h1>

<ul>
<li>a  <code class="language-javascript">Promise</code> in JavaScript is a commitment that sometime in the future, your code will get a <strong>value</strong> from some operation (like reading a file or getting JSON from a Web site) or your code will get <strong>an error</strong> from that operation (like the file doesn&apos;t exist or the Web site is down).</li>
<li>Creating  <code class="language-javascript">Promise</code> objects with the  <code class="language-javascript">Promise</code> constructor:
<ul>
<li>Accepts a function that has two parameters that are each functions themselves:
<ul>
<li> <code class="language-javascript">resolve()</code> transitions the  <code class="language-javascript">Promise</code> object to the fulfilled state</li>
<li> <code class="language-javascript">reject()</code> transitions the  <code class="language-javascript">Promise</code> object to the rejected state</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do some async stuff						</span>
  <span class="token comment">// call resolve(value) to make the Promise succeed</span>
  <span class="token comment">// call reject(reason) to make the Promise fail	 </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><ul>
<li> <code class="language-javascript">Promise</code>s can exist in three states:
<ul>
<li><strong>Pending</strong>: The  <code class="language-javascript">Promise</code> object has not resolved. Once it does, the state of the  <code class="language-javascript">Promise</code> object may transition to either the fulfilled or rejected state.</li>
<li><strong>Fulfilled</strong>: Whatever operation the  <code class="language-javascript">Promise</code> represented succeeded and your success handler will get called. Now that it&apos;s fulfilled, the  <code class="language-javascript">Promise</code>:
<ul>
<li>must not transition to any other state.</li>
<li>must have a value, which must not change.</li>
<li>fulfilled Promise objects can be created by using:<br>
 <code class="language-javascript">Promise.resolve(value)</code></li>
</ul>
</li>
<li><strong>Rejected</strong>: Whatever operation the Promise represented failed and your error handler will get called. Now that it&apos;s rejected, the Promise:
<ul>
<li>must not transition to any other state.</li>
<li>must have a reason, which must not change.</li>
<li>If a  <code class="language-javascript">Promise</code> object transitions to the rejected state and no error handler exists for the  <code class="language-javascript">then</code>, then that  <code class="language-javascript">then</code> is skipped altogether.</li>
</ul>
</li>
</ul>
</li>
<li> <code class="language-javascript">Promise</code> objects have the following methods available on them so that you can handle the state change from pending to either fulfilled or rejected.
<ul>
<li> <code class="language-javascript">then(successHandler, errorHandler)</code> is a way to handle a  <code class="language-javascript">Promise</code> when it leaves the pending state.<br>
catch(errorHandler)</li>
</ul>
</li>
<li>The handlers mentioned in the previous list are:
<ul>
<li><strong> <code class="language-javascript">Success Handler</code></strong> is a function that has one parameter, the value that a fulfilled  <code class="language-javascript">Promise</code> has.</li>
<li><strong> <code class="language-javascript">Error Handler</code></strong> is a function that has one parameter, the reason that the  <code class="language-javascript">Promise</code> failed.</li>
</ul>
</li>
</ul>
<h4 class="mume-header" id="then"> <code class="language-javascript">then()</code></h4>

<ul>
<li>handles what will happen when the  <code class="language-javascript">Promise</code> comes out of the <strong>pending</strong> state.</li>
<li>each returns another  <code class="language-javascript">Promise</code> that transitions out of it&apos;s pending state when the  <code class="language-javascript">then</code> that created it completes</li>
<li>You can pass a second argument into the then method as the  <code class="language-javascript">error handler</code> (essentially saying, if this then does not resolve, then this error handler will do something.)</li>
</ul>
<h4 class="mume-header" id="chaining-then">Chaining  <code class="language-javascript">then()</code></h4>

<ul>
<li>In the case of an error, the chain of  <code class="language-javascript">then</code>s will evaluate as:
<ol>
<li>First  <code class="language-javascript">then</code>: I do not have an error handler. I will pass the error on and not run the success handler.</li>
<li>Second  <code class="language-javascript">then</code>: I do not have an error handler. I will pass the error on and not run the success handler.</li>
<li>Third  <code class="language-javascript">then</code>: I have an error handler and will run it.</li>
</ol>
</li>
<li>The success handler is called with the value of the operation of the  <code class="language-javascript">Promise</code> when the  <code class="language-javascript">Promise</code> object transitions to the fulfilled state. If an error condition occurs, them the error handler of the then is called.</li>
<li>If a  <code class="language-javascript">Promise</code> object transitions to the rejected state and no error handler exists for the  <code class="language-javascript">then</code>, then that  <code class="language-javascript">then</code> is skipped altogether.</li>
<li>If an error handler is called and does not raise an exception, then the next  <code class="language-javascript">Promise</code> object transitions to the fulfilled state and the next success handler is called.</li>
</ul>
<h4 class="mume-header" id="catch"> <code class="language-javascript">catch()</code></h4>

<ul>
<li>Rather than using a  <code class="language-javascript">then</code> with a success and error handler, you can use the similar  <code class="language-javascript">catch</code> method that takes just an error handler.</li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token function">promiseFunction</span><span class="token punctuation">(</span><span class="token string">&quot;print&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>&#x201C;anonymous <span class="token keyword">function</span> text&#x201D;<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">reason</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">&quot;Badness happened&quot;</span><span class="token punctuation">,</span> 		reason<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><ul>
<li>If the  <code class="language-javascript">catch</code> doesn&apos;t throw an exception, then it returns a  <code class="language-javascript">Promise</code> in a fulfilled state with whatever the return value is, just like the  <code class="language-javascript">error handler</code> of a  <code class="language-javascript">then</code>.</li>
</ul>
<h4 class="mume-header" id="promiseall"> <code class="language-javascript">Promise.all()</code></h4>

<ul>
<li>accepts an array of values and returns a new  <code class="language-javascript">Promise</code> object in the pending state colloquially called a &quot;<strong>super promise</strong>&quot;.</li>
<li>converts all non- <code class="language-javascript">Promise</code> values into  <code class="language-javascript">Promise</code> objects that are immediately in the <strong>fulfilled</strong> state.</li>
<li>If any one of the  <code class="language-javascript">Promise</code>s in the array transitions to the rejected state, then the &quot;super promise&quot; transitions to the rejected state with the same reason that the inner  <code class="language-javascript">Promise</code> object failed.</li>
<li>If all of the inner  <code class="language-javascript">Promise</code> objects in the array transition to the <strong>fulfilled</strong> state, then the &quot;super promise&quot; transitions to the <strong>fulfilled</strong> state with a value of an array populated with all of the resolved values of the original array.</li>
</ul>
<h4 class="mume-header" id="async"> <code class="language-javascript">async</code></h4>

<ul>
<li>Declaring a function with  <code class="language-javascript">async</code> will make it implicitly return a  <code class="language-javascript">Promise</code> if it doesn&#x2019;t</li>
<li>will return immediately resolved value of resolve</li>
</ul>
<h4 class="mume-header" id="await"> <code class="language-javascript">await</code></h4>

<ul>
<li>when a  <code class="language-javascript">Promise</code> is  <code class="language-javascript">await</code>ed, execution of the containing  <code class="language-javascript">async</code> function will pause until the promise is fulfilled</li>
<li>once fulfilled, the  <code class="language-javascript">await</code> expression will evaluate to the resolved value of the  <code class="language-javascript">Promise</code></li>
<li>using  <code class="language-javascript">await</code> outside of an  <code class="language-javascript">async</code> function will result in a  <code class="language-javascript">SyntaxError</code></li>
<li>use  <code class="language-javascript">try&#x2026;catch</code> pattern to handle errors when the  <code class="language-javascript">Promise</code> is rejected</li>
</ul>
<h5 class="mume-header" id="refactoring-a-promise-chain-from-then-to-await">Refactoring a Promise chain from .then to await</h5>

<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">function</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  promise1
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> promise2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res2</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> promise3<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res3</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>with async/await&#x2026;</p>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> promise1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> promise2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> promise3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> promise4<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h4 class="mume-header" id="fetch"> <code class="language-javascript">fetch</code></h4>

<ul>
<li>Use the  <code class="language-javascript">fetch</code> API to make  <code class="language-javascript">Promise</code>-based API calls</li>
<li> <code class="language-javascript">fetch</code> takes 2 parameters:
<ul>
<li>url</li>
<li>an object with options for the request</li>
</ul>
</li>
<li>returns a  <code class="language-javascript">Promise</code></li>
</ul>
<pre data-role="codeBlock" data-info="js" class="language-javascript"><span class="token keyword">const</span> fetch <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&apos;node-fetch&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">MOVIE_API_KEY</span> <span class="token operator">=</span> <span class="token string">&quot;some-api-key&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token string">`https://omdbapi.com/?apikey=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">MOVE_API_KEY</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;t=fight+club`</span></span>

<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>Actors<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">reason</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&apos;rejected because&apos;</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre>
      </div>
      <div class="md-sidebar-toc"><ul>
<li><a class="btn" href="#promises">Promises</a><br>
- <a class="btn" href="#then"> <code class="language-javascript">then()</code></a><br>
- <a class="btn" href="#chaining-then">Chaining  <code class="language-javascript">then()</code></a><br>
- <a class="btn" href="#catch"> <code class="language-javascript">catch()</code></a><br>
- <a class="btn" href="#promiseall"> <code class="language-javascript">Promise.all()</code></a><br>
- <a class="btn" href="#async"> <code class="language-javascript">async</code></a><br>
- <a class="btn" href="#await"> <code class="language-javascript">await</code></a><br>
- <a class="btn" href="#refactoring-a-promise-chain-from-then-to-await">Refactoring a Promise chain from .then to await</a><br>
- <a class="btn" href="#fetch"> <code class="language-javascript">fetch</code></a></li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>








<script async>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>


    </body></html>
